---
title: Diretrizes para o Lançamento de Planos de Projetos
authors: 
  - Navin Ruas 
  - Jamil Matos
date: 02/05/2023
lang: pt-BR
output:
  powerpoint_presentation:
    reference_doc: template.pptx
  pdf_document:
    toc: true
    toc_depth: 2
    number_sections: true
---

# Maximizando a Colaboração e Produtividade: Integração do SharePoint e SiSGP

## Diretrizes para o Lançamento de Planos de Projetos

- Verificações Diárias.

### Verificação de Plano de Trabalho de Servidor

#### Objetivo

Verificar se os servidores possuem um plano de trabalho válido e enviar notificações caso não possuam.

#### Condições para um plano de trabalho não coberto

SituacaoPactoTrabalho = ‘’ ‘Rejeitado’ ‘Rascunho’ ‘Executado’.

#### Ações a serem tomadas

1. Caso o servidor não tenha um plano de trabalho válido, enviar um aviso ao servidor.
2. Se após 2 dias do primeiro aviso o servidor ainda não tiver um plano de trabalho válido, enviar um segundo aviso ao servidor e ao supervisor.

#### Passos

1. Obter a lista de servidores do banco SQL Portalina usando a função `pontalina(query)` do arquivo `Conexao.py`.
2. Obter a lista de férias do banco SQL Auditor usando a função `auditoria(query)` do arquivo `Conexao.py`.
3. Para cada servidor na lista de servidores:
  1. Verificar se o servidor está na lista de férias. Se estiver, ignorar e passar para o próximo servidor.
  2. Verificar o status SituacaoPactoTrabalho do servidor no banco SQL Portalina usando a função `pontalina(query)` do arquivo `Conexao.py`.
  3. Se o status SituacaoPactoTrabalho for ‘’ ‘Rejeitado’ ‘Rascunho’ ‘Executado’:
    1. Verificar se o servidor já foi notificado anteriormente (verificando em um arquivo `notificado.json`).
    2. Se o servidor não foi notificado anteriormente, enviar o primeiro aviso ao servidor usando a função `enviar_notificacao(servidor, mensangem)` do arquivo `Email.py` e registrar no arquivo `notificado.json` que o servidor foi notificado uma vez.
    3. Se o servidor já foi notificado uma vez e já se passaram 2 dias desde o primeiro aviso, enviar o segundo aviso ao servidor e ao supervisor usando as funções `enviar_notificacao(servidor, mensagem)` e `enviar_notificacao_supervisor(servidor, menagem)` do arquivo Email.py e registrar no arquivo `notificado.json` que o servidor foi notificado duas vezes.

#### Observações

- As conexões com os bancos de dados Portalina e Auditor devem ser implementadas em um arquivo local chamado `Conexao.py`, que possui as funções `pontalina(query)` e `auditoria(query)`.
- As funções para enviar as notificações por email devem ser implementadas em um arquivo externo chamado `Email.py`.
- As mensagens de notificação estarão também em arquivos externos `avisoNCob1.html` e `avisoNCob2.html`.

### Validar Conclusão do Plano de Trabalho

#### Objetivo

Verificar se os servidores concluíram todas as atividades do plano de trabalho dentro do prazo e enviar notificações caso não tenham.

#### Ações a serem tomadas

1. Caso o plano de trabalho não esteja com todas as atividades concluídas até o prazo, enviar um aviso ao servidor.

#### Passos

1. Obter dados do SQL usando a consulta SELECT *.
2. Separar os dados por servidor e verificar o status mais recente de SituacaoPactoTrabalho para cada servidor.
3. Para cada servidor:
  1. Se todas as atividades com o mesmo pactoTrabalhoId tiverem status Concluída, ignorar e passar para o próximo servidor.
  2. Se a data DtFimPactoTrab estiver faltando 1 dia para vencer, enviar uma notificação ao servidor usando o arquivo HTML avisoConc1.html.
  3. Se a data DtFimPactoTrab já estiver vencida, enviar uma notificação ao servidor e ao supervisor usando o arquivo HTML avisoNConc.html.
  4. Adicionar o servidor à lista de servidores não concluídos em um arquivo nConc.json.
  5. Verificar se os servidores na lista já concluíram as atividades. Caso tenham concluído, remover da lista.

#### Observações

- As conexões com o banco de dados SQL devem ser implementadas em um arquivo local chamado Conexao.py, que possui uma função para executar consultas SQL.
- As funções para enviar as notificações por email devem ser implementadas em um arquivo externo chamado Email.py.
- As mensagens de notificação estarão também em arquivos externos avisoConc1.html e avisoNConc.html.


### Verificar Campo Descrição
- Caso trabalho 'Enviado para Aceite'.
- Verificar se Descrição está correta.
- Verificar se Descrição coincide com atividade.
- Caso erro, apontar o(s) erro(s) ao servidor. Para servidor e Supervisor.
- Caso tudo correto, enviar para supervisor para Análise.


### Verificar existencia do produto no eAud
- Atividade Avaliação ou Consultoria.
- Se não houver arquivo na id do eAud.
- No dia seguinte avisar supervisor e servidor novamente.
- Se concluído atividades e produtos avisar supervisor.

### Atualizar Gerador de Descrição

### Atualização do Dashboard Gerencial SharePoint
- 'Em Execução' ou 'Autorizado' enviar dados para SharePoint.